{% extends 'base/base.html' %}

{% block title %}
多空看板
{% endblock %}

{% block content %}
<div id="main"></div>
<div class="weui_tab">
    <div class="weui_navbar">
        <a href="#rise" class="weui_navbar_item{% if token == 'all' or not token %} weui_bar_item_on{% endif %}">
            <span>看多</span>
        </a>
        <a href="#drop" class="weui_navbar_item{% if token == 'mine' %} weui_bar_item_on{% endif %}">
            <span>看空</span>
        </a>
        <a href="#bumpy" class="weui_navbar_item{% if token == 'mine' %} weui_bar_item_on{% endif %}">
            <span>看平</span>
        </a>
    </div>
    <div class="weui_tab_bd">
        {% for d in data %}
        <div id="{{ d.viewpoint }}" class="weui_tab_bd_item{% if d.viewpoint == 'rise' %} weui_tab_bd_item_active{% endif %}">
            <div class="weui_cells">
                {% for obj in d.items %}
				<a class="weui_cell weui_cells_access" href="{% url 'bigvs_detail' obj.bigv.v_id %}">
				    <div class="weui_cell_hd">
				        <img src="/static/images/bv.png" alt="icon" style="">
				    </div>
				    <div class="weui_cell_bd weui_cell_primary">
				        <p class="cell_title">
				          {{ obj.bigv.name|default_if_none:'' }}
				          <span>{{ obj.bigv.words_weight|default_if_none:0 }}</span>
				        </p>
				        <p class="cell_desc">{{ obj.article.publish_date|date:'m-d H:i' }} 来自{{ obj.article.article_source }}</p>
				    </div>
				</a>
				<a class="weui_cell weui_cells_access content" href="{{ obj.article.get_absolute_url }}">
				    <div class="weui_cell_hd">
				    </div>
				    <div class="weui_cell_bd weui_cell_primary">
				        <p class="cell_title">
				          {{ obj.article.title|default_if_none:''|truncatechars:20 }}
				        </p>
				        <p class="cell_desc">{{ obj.article.content|striptags|truncatechars:80 }}
				    </div>
				</a>
				{% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>

{% endblock %}

{% block css %}
<style>
  #main{
    width: 280px;
    height: 280px;
    margin: auto;
  }
  .weui_cell, .weui_cell:before {
    border-top: 1px solid #fff;
  }
</style>
{% endblock %}

{% block js %}
<script src="/static/js/echarts.simple.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
    	// 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));
        // 指定图表的配置项和数据
        var option = {
            series: [{
                name: '',
                type: 'pie',
                radius : '60%',
                center: ['50%', '50%'],
                color: ['#FF0000', '#00FF00', '#5F9F9F'],
                data: [
                {% for d in data %}
                {'value': {{ d.value }}, 'name': '{{ d.name }}'},
                {% endfor %}
                ]
            }]
        };
        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        $(window).scroll(function(){
            var top = $("#main").height();
            var scrollTop = $(window).scrollTop();
            if(scrollTop>=top){
            	$(".weui_navbar").css({'position':'fixed'});
            }else{
            	$(".weui_navbar").css({'position':'absolute'});
            }
        });
    });
    
</script>
{% endblock %}
